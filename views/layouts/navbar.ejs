<style>
    /* Style for the circular count */
    @media (max-width: 768px) {
    .header-right {
        display: none;
    }
}

    .cart-count,
    .wishlist-count {
        display: inline-block;
        width: 20px;
        height: 20px;
        background-color: #cc9966; /* Background color of the circle */
        border-radius: 50%; /* Make it a circle */
        color: #fff; /* Text color */
        font-size: 12px; /* Font size of the count */
        text-align: center; /* Center the count horizontally */
        line-height: 20px; /* Center the count vertically */
        position: absolute;
        top: 0;
        right: -10px;
        padding: 2px;
    }

    /* Adjustment for the position of the cart count */
    .cart-count {
        right: -10px;
    }

    /* Adjustment for the position of the wishlist count */
    .wishlist-count {
        right: -10px;
        
    }
    nav.main-nav {
    margin-left: 180px; /* Adjust the margin value as needed */
}
    
</style>

<header class="header">
    <div class="header-middle sticky-header">
        <div class="container">
            <div class="header-left ">
                <button class="mobile-menu-toggler">
                    <span class="sr-only">Toggle mobile menu</span>
                    <i class="icon-bars"></i>
                </button>
                <a href="index.html" class="logo">
                    <img src="/assets/images/backgrounds/brand-logo.jpg" alt="FurnIt Logo" width="155" height="45">
                </a>
                <nav class="main-nav ">
                    <ul class="menu sf-arrows ml-3">
                        <li class="megamenu-container active">
                            <a href="/home" class="sf-with-ul">Home</a>
                        </li>
                        <li>
                            <a href="/allproducts" class="sf-with-ul">Shop</a>
                        </li>
                        <li>
                            <a href="/aboutus" class="sf-with-ul">About Us</a>
                        </li>
                        <li>
                            <a href="/contactus" class="sf-with-ul">Contact Us</a>
                        </li>
                    </ul><!-- End .menu -->
                </nav><!-- End .main-nav -->
            </div><!-- End .header-left -->

            

            <div class="header-right">
                <div class="header-search">
                    <a href="#" class="search-toggle" role="button"><i class="icon-search"></i></a>
                    <form action="#" method="get">
                        <div class="header-search-wrapper">
                            <label for="q" class="sr-only">Search</label>
                            <input type="search" class="form-control" name="q" id="q" placeholder="Search in..." required>
                        </div><!-- End .header-search-wrapper -->
                    </form>
                </div><!-- End .header-search -->
                <div class="dropdown compare-dropdown">
                    <a href="/wishlist" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" data-display="static" title="Wishlist" aria-label="Compare Products">
                        <i class="icon-heart-o"></i>
                        <span class="wishlist-count"><%= locals.wishlistCount %></span> <!-- Render wishlist count dynamically -->
                    </a>
                </div><!-- End .compare-dropdown -->

                <div class="dropdown cart-dropdown">
                    <a href="/cart" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" data-display="static">
                        <i class="icon-shopping-cart"></i>
                        <span class="cart-count"><%= locals.cartCount %></span> <!-- Render cart count dynamically -->
                    </a>
                </div><!-- End .cart-dropdown -->


                <div class="dropdown cart-dropdown">
                    <% if (locals.userAuthenticated) { %>
                        <!-- If the user is logged in, display user info and logout button -->
                        <a href="#" class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static">
                            <i class="icon-user"></i><p><%= username %></p>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            <div class="dropdown-cart-action d-flex justify-content-between align-items-center">
                                <p class="mb-0">Your Email: <%= email %></p>
                                <div class="btn-group">
                                    <a href="/profile" class="btn btn-secondary mr-3">Your Profile</a> <!-- Added mr-2 for right margin -->
                                    <a href="/logout" class="btn btn-primary">Logout</a>
                                </div>
                            </div>
                        </div>
                    <% } else { %>
                        <!-- If the user is not logged in, display a login button -->
                        <a href="/login" class="btn btn-outline-primary">Login</a>
                    <% } %>
                </div>

                <style>
                    .dropdown-cart-action {
                        display: flex;
                        flex-direction: column;
                        align-items: flex-start;
                    }
                    
                </style>
            </div><!-- End .header-right -->
        </div><!-- End .container -->
    </div><!-- End .header-middle -->
</header><!-- End .header -->

<!-- Mobile Menu -->
<!-- Mobile Menu -->
<!-- Mobile Menu -->
<!-- Mobile Menu -->
<div class="mobile-menu-overlay"></div><!-- End .mobile-menu-overlay -->

<div class="mobile-menu-container">
    <div class="mobile-menu-wrapper">
        <span class="mobile-menu-close"><i class="icon-close"></i></span>

        <% if (locals.userAuthenticated) { %>
            <!-- Display username if the user is logged in -->
            <div class="user-info text-center" >
                <p><strong><%= username %></strong></p>
            </div>
        <% } %>

        <form action="#" method="get" class="mobile-search">
            <label for="mobile-search" class="sr-only">Search</label>
            <input type="search" class="form-control" name="mobile-search" id="mobile-search" placeholder="Search in..." required>
            <button class="btn btn-primary" type="submit"><i class="icon-search"></i></button>
        </form> 
        
        <nav class="mobile-nav">
            <ul class="mobile-menu">
                <li class="active">
                    <a href="/home">Home</a>
                </li>
                <li>
                    <a href="/allproducts" class="sf-with-ul">Shop</a>
                </li>
                <li>
                    <a href="/aboutus">About Us</a>
                </li>
                <li>
                    <a href="/contactus">Contact Us</a>
                </li>
                <li>
                    <a href="/wishlist">Wishlist <span class="wishlist-count"><%= locals.wishlistCount %></span></a>
                </li>
                <li>
                    <a href="/cart">Cart <span class="cart-count"><%= locals.cartCount %></span></a>
                </li>
                <% if (locals.userAuthenticated) { %>
                    <li>
                        <a href="/profile">Your Profile</a>
                    </li>
                    <li>
                        <a href="/logout">Logout</a>
                    </li>
                <% } else { %>
                    <li>
                        <a href="/login">Login</a>
                    </li>
                <% } %>
            </ul>
        </nav>
        
    </div><!-- End .mobile-menu-wrapper -->
</div><!-- End .mobile-menu-container -->


<script>
    
    $(document).ready(function() {
    var mobileMenu = $('.mobile-menu-container .mobile-menu');
    var headerRightContent = $('.header-right').html();

    // Check if the screen size is below the breakpoint
    if ($(window).width() <= 768) {
        // Append the header-right content to the mobile menu
        mobileMenu.append(headerRightContent);
    }

    // Listen for window resize event
    $(window).resize(function() {
        if ($(window).width() <= 768) {
            mobileMenu.append(headerRightContent);
        } else {
            // Remove the header-right content from the mobile menu
            mobileMenu.find('.header-right').remove();
        }
    });
});

</script>